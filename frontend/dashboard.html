<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Directeur - Gestion Pédagogique</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>Gestion Pédagogique</h1>
                <p id="user-name">Directeur</p>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-item active" data-section="dashboard">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="7" height="7"></rect>
                        <rect x="14" y="3" width="7" height="7"></rect>
                        <rect x="14" y="14" width="7" height="7"></rect>
                        <rect x="3" y="14" width="7" height="7"></rect>
                    </svg>
                    <span class="nav-text">Tableau de bord</span>
                </div>
                <div class="nav-item" data-section="formateurs">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    <span class="nav-text">Formateurs</span>
                </div>
                <div class="nav-item" data-section="promotions">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5M2 12l10 5 10-5"></path>
                    </svg>
                    <span class="nav-text">Promotions</span>
                </div>
                <div class="nav-item" data-section="etudiants">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    <span class="nav-text">Étudiants</span>
                </div>
                <div class="nav-item" data-section="espaces">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                    </svg>
                    <span class="nav-text">Espaces Pédagogiques</span>
                </div>
            </nav>
            <div class="sidebar-footer">
                <button class="btn btn-secondary" onclick="logout()" style="width: 100%;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    <span class="nav-text">Déconnexion</span>
                </button>
            </div>
        </aside>

        <main class="main-content">
            <div id="section-dashboard">
                <div class="header">
                    <h1>Tableau de bord</h1>
                </div>
                <div class="stats-grid" id="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon blue">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-formateurs">0</h3>
                            <p>Formateurs</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon green">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="9" cy="7" r="4"></circle>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-etudiants">0</h3>
                            <p>Étudiants</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon orange">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                                <path d="M2 17l10 5 10-5M2 12l10 5 10-5"></path>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-promotions">0</h3>
                            <p>Promotions</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon red">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                            </svg>
                        </div>
                        <div class="stat-info">
                            <h3 id="stat-espaces">0</h3>
                            <p>Espaces Pédagogiques</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="section-formateurs" class="hidden">
                <div class="header">
                    <h2>Formateurs</h2>
                     <div class="search-box">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input type="text" id="search-formateurs" placeholder="Rechercher un formateur..." onkeyup="filterTable('formateurs-table', this.value)">
                    </div>

                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openFormateurModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            Nouveau formateur
                        </button>
                    </div>
                </div>
                <div class="card">
                   
                    <div class="table-responsive">
                        <table id="formateurs-table">
                            <thead>
                                <tr>
                                    <th>Nom complet</th>
                                    <th>Email</th>
                                    <th>Téléphone</th>
                                    <th>Spécialité</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="formateurs-list">
                                <tr><td colspan="6" style="text-align: center; padding: 40px;">Chargement...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="section-promotions" class="hidden">
                <div class="header">
                    <h1>Promotions</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openPromotionModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            Nouvelle promotion
                        </button>
                    </div>
                </div>
                <div class="card">
                    <div class="search-box">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input type="text" id="search-promotions" placeholder="Rechercher une promotion..." onkeyup="filterTable('promotions-table', this.value)">
                    </div>
                    <div class="table-responsive">
                        <table id="promotions-table">
                            <thead>
                                <tr>
                                    <th>Nom</th>
                                    <th>Année début</th>
                                    <th>Année fin</th>
                                    <th>Étudiants</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="promotions-list">
                                <tr><td colspan="5" style="text-align: center; padding: 40px;">Chargement...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="section-etudiants" class="hidden">
                <div class="header">
                    <h1>Étudiants</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openEtudiantModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            Nouvel étudiant
                        </button>
                    </div>
                </div>
                <div class="card">
                    <div class="search-box">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input type="text" id="search-etudiants" placeholder="Rechercher un étudiant..." onkeyup="filterTable('etudiants-table', this.value)">
                    </div>
                    <div class="table-responsive">
                        <table id="etudiants-table">
                            <thead>
                                <tr>
                                    <th>Nom complet</th>
                                    <th>Email</th>
                                    <th>Matricule</th>
                                    <th>Promotion</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="etudiants-list">
                                <tr><td colspan="6" style="text-align: center; padding: 40px;">Chargement...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="section-espaces" class="hidden">
                <div class="header">
                    <h1>Espaces Pédagogiques</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openEspaceModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            Nouvel espace
                        </button>
                    </div>
                </div>
                <div class="card">
                    <div class="search-box">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input type="text" id="search-espaces" placeholder="Rechercher un espace..." onkeyup="filterTable('espaces-table', this.value)">
                    </div>
                    <div class="table-responsive">
                        <table id="espaces-table">
                            <thead>
                                <tr>
                                    <th>Matière</th>
                                    <th>Code</th>
                                    <th>Coefficient</th>
                                    <th>Formateurs</th>
                                    <th>Étudiants</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="espaces-list">
                                <tr><td colspan="6" style="text-align: center; padding: 40px;">Chargement...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="section-directeurs" class="hidden">
                <div class="header">
                    <h1>Directeurs</h1>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openDirecteurModal()">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                            </svg>
                            Nouveau directeur
                        </button>
                    </div>
                </div>
                <div class="card">
                    <div class="search-box">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input type="text" id="search-directeurs" placeholder="Rechercher un directeur..." onkeyup="filterTable('directeurs-table', this.value)">
                    </div>
                    <div class="table-responsive">
                        <table id="directeurs-table">
                            <thead>
                                <tr>
                                    <th>Nom complet</th>
                                    <th>Email</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="directeurs-list">
                                <tr><td colspan="3" style="text-align: center; padding: 40px;">Chargement...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div class="bottom-nav">
        <div class="bottom-nav-item active" data-section="dashboard">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7"></rect>
                <rect x="14" y="3" width="7" height="7"></rect>
                <rect x="14" y="14" width="7" height="7"></rect>
                <rect x="3" y="14" width="7" height="7"></rect>
            </svg>
            Dashboard
        </div>
        <div class="bottom-nav-item" data-section="formateurs">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                <circle cx="12" cy="7" r="4"></circle>
            </svg>
            Formateurs
        </div>
        <div class="bottom-nav-item" data-section="promotions">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
            </svg>
            Promotions
        </div>
        <div class="bottom-nav-item" data-section="etudiants">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
            </svg>
            Étudiants
        </div>
        <div class="bottom-nav-item" data-section="espaces">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
            </svg>
            Espaces
        </div>
    </div>

    <div id="modal" class="modal"></div>
    <div id="toast-container" class="toast-container"></div>

    <script src="auth.js"></script>
    <script src="script.js"></script>
    <script>
        console.log('=== INITIALISATION DASHBOARD ===');
        
        if (!checkAuth(['directeur'])) {
            console.error('Auth failed');
        } else {
            console.log('Auth OK');
            const user = getCurrentUser();
            console.log('User:', user);
            document.getElementById('user-name').textContent = user.nom_complet;
            
            document.querySelectorAll('.nav-item, .bottom-nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const section = this.getAttribute('data-section');
                    console.log('Click detected on:', section);
                    if (section) {
                        showSection(section);
                    }
                });
            });
            
            loadDashboard();
        }
    </script>
</body>
</html>
